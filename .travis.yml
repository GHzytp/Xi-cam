language: python
python:
- '3.6'
branches:
  only:
  - master
sudo: false
cache:
  apt: true
  pip: true
  directories: 
addons:
  apt:
    packages:
    - qtbase5-dev
install:
- pip install cx_freeze==6.0b1
- pip install coveralls pytest
- pip install git+https://github.com/lbl-camera/Xi-cam.core.git
- pip install git+https://github.com/lbl-camera/Xi-cam.plugins.git
- pip install git+https://github.com/lbl-camera/Xi-cam.gui.git
- pip install .
script:
- pip install pylint twine wheel
- 'pylint xicam --errors-only || :'
- pip install coverage
- sh -e /etc/init.d/xvfb start
- sleep 3
- pytest .
- python setup.py install
- python setup.py bdist_wheel
- python setup.py sdist
- python setup.py bdist_egg
- python setup.py build_exe
#- twine upload dist/*
after_success:
- pip install codecov --upgrade
- bash <(curl -s https://codecov.io/bash)
deploy:
  provider: pypi
  user: "ronpandolfi"
  password:
    secure: EZ8GJrbgZRl8BlJ5QLWO81g6ainnR4l6QRAsYOXCAWqU0Qi4BZwWKpbSlIkf4TJRgOqEVa26WGltK22kbX30FrIpn9UEtd8GCisz2CzT4p6DMX7WgtdKawuVu4M/c70FC7AMGoIWVKlE2aW5rwBHxhmm9uskqUnek2EvX6ZmWG8wuWbnv7ugUkSsAYSxe3xS+oH1MpEB1RjXP7Ur2C67qsmv9XX7qzu4iqsa8t24P5UasWliPQ3aV6a1UtNm5OlBLnmCJmPpWCSKdv/RKUE0BtViKn+FPumsXCo8VZmUbUZMnlCUdCO242llVdBZLpIRPLKx9FGyI9i00kS5XrSpYt1YbvoqT3sHUDkDKhiS4sDUCpMyVanX+aEqKtJqI9m+wuLJQsIsYwvPvKYE+UTtJAoD/qaHKVXcYP6cWUrZ0YlTIBAcSeUGrWq8BX4QyJJ3UxyURD0NF+tfEzmc2piyfzSJMWPLVchw3B/xNYhUoZcxPZgtXR1QpzDvNpKERIsbW8RCZStw/fBScLgWL3rOlmejBPolOdVXyIqHCr1DLsOpm3N4VLGQ3pnvoGWyqGGS61XTxVJQOJTjCs4nMZECqwlYb2SHkpOZ21wCKjl//fY/UhyaZzhpm9Cze/d4009hO6JRwEyRu/LCl7b9QYteyPpkNqvIEx3+A0ht4KTlvos=
  distributions: "sdist bdist_wheel bdist_egg"