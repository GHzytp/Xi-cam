language: python
python:
- '3.6'
branches:
  only:
  - master
sudo: false
cache:
  apt: true
  pip: true
  directories: 
addons:
  apt:
    packages:
    - qtbase5-dev
install:
- pip install cx_freeze==6.0b1
- pip install coveralls pytest
- pip install git+https://github.com/lbl-camera/Xi-cam.core.git
- pip install git+https://github.com/lbl-camera/Xi-cam.plugins.git
- pip install git+https://github.com/lbl-camera/Xi-cam.gui.git
- pip install .
script:
- pip install pylint twine wheel
- 'pylint xicam --errors-only || :'
- pip install coverage
- sh -e /etc/init.d/xvfb start
- sleep 3
- 'pytest . || :'
- python setup.py install
after_success:
- pip install codecov --upgrade
- bash <(curl -s https://codecov.io/bash)
deploy:
  provider: pypi
  user: ronpandolfi
  password:
    secure: rFiHJ+AabB49b31JE3qWT8Hta5aCVOZkwPbANEcb+a7odXVIi0SZUb0XmdC9821klXUKJkuXRNjw/+kMvTxB/kbCWt4vqRrcc44CVe6/oV5VD3GSU5wttJXERYQ9dk928VWxjTI0cjCqjGKlKDRr0DPrFedEUngtUCHlokAut0szSUhkCgHWNh5EDtPTWpr954h70wFUZ2s0/RNZTVI/MEa+zOXsHqyrSnThQvqdeTyPb12QQwuSAjDiCOz6oFSmrQM8MoXFuQ70KglnZHB6c0Dv708iNnp0iI32PSnRWf2Ygp78Hs+qV+53CwJKpFUaefKQTaLBvSIop9XHQDfu95t3ocFxNojViL2r2pqzbdqtsxom7P6Cdk6IMIwGCKRofiiqKf2RkxGJglxyFw3GPje1D7pHTgCaLAJKIFczawXiFsmfWqW5Zwan62MmvBczf4v1SkRC4f5zfP+1EUeYezVtd8+WNpUOG572Y7YRTehjSoti5UYxTd9bkvbbOOrZQTJTH+0exugNh2K2nEm+7K5WBqpRZ1dWH/DMFcfIqOMlINAX8VfiMzc2RC52Kc4/nC+e5yqxJtUK0+iF/xm3/rppCmsbDL/UzCpx61Tf8e801gwiBx2UqEsIQ47DioA923J1DdVaU2XeaBHkP9cBbvzF3NOzI9a030rg84UYdOE=
  distributions: sdist bdist_wheel bdist_egg
